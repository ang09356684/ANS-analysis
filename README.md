# ANS analysis
手動點選檔案分析 (分析數量少可用)
使用spyder 打開 HRV analysis program.py
此程式分三部分 以# %%做區分 (分段執行是為了找出睡眠時間)

第一部分點選右鍵 Run cell 或 shift + enter會跳出以下視窗
選擇第一天的4個txt檔 ACT、HR、HRV、Ln(HRV) 
選擇完後 會再自動跳出一次 請選擇第二天的資料 
若非連續日期 請在第二次跳出時按取消 隨後出現的錯誤訊息可以直接按ok 
(至少要有第一天的資料才可進行分析 )

第二部分為繪圖 (若使用網頁查看時間可跳過此步驟)
點選右鍵 Run cell 或 shift + enter 以HR與ACT繪出的折線圖
若資料為跨日資料 會顯示到第二天中午為止的資料
將滑鼠移到該位置上 下方會顯示實際的時間 
請記錄下HR 與 ACT 同時開始顯著降低與提升的時間點 
此段時間為睡眠時間 請將此時間另外紀錄在excel上

第三步驟
依格式輸入睡眠開始與結束時間
輸入完後 點選右鍵 Run cell 或 shift + enter
會將HRV數據計算完後 輸出到excel

已經紀錄每一筆的睡眠時間後 可直接自動化分析
打開 HRV auto analysis.py
點選執行 會將所有受試者HRV 計算在同一個excel檔案中


補充說明
為了確保資料是在穩定睡眠中所記錄的，因此將ACT > 10的該筆資料刪除，排除夜間活動的情況。
將睡眠時間分成九個時間段：整晚睡眠期間、睡眠第一小時、睡眠第二小時、睡眠前兩小時、睡眠前半夜、睡眠後半夜、睡眠後兩小時、睡眠倒數第二小時、睡眠最後一小時。
在每一時間區段將各項參數排序後，去除前後5%的極端值，再各別計算其平均值。
最後檢視excel該時間區段的error %是否大於20%，若大於視為該時間區段紀錄品質不佳
